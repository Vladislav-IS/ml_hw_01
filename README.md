# Домашнее задание 1
## Семенов Владислав Юрьевич, vliusemenov@edu.hse.ru

В рамках этого домашнего задания предлагалось построить модель регрессии для предсказания стоимость автомобиля по его характеристикам.

Что было сделано:
- проведен анализ данных: заполнены пропуски, удалены дубликаты. Проведен анализ взаимосвязи переменных: оказалось, что selling_price главным образом зависит от года выпуска авто и его технических характеристик; при этом сами технические характеристики тоже сильно коррелируют друг с другом (что логично).
- выполнено преобразование данных для улучшения качества обучения: нормализация данных, кодирование категориальных признаков методом OHE, добавление новых признаков на основе существующих.
- обучено несколько моделей: обычная линейная регрессия, лин. регрессия с L0, L1, L2-регуляризацией. Наибольший прирост качества получен для обычной линейной регрессии после добавления новых признаков (возведение в квадрат года выпуска и пробега, добавление удельной мощности авто к объему двигателя, добавление флага, характеризующего отсутсвие у авто предыдущих владельцев) и преобразования столбца названия авто (для каждого автомобиля были оставлены только 2 первых слова: марка и модель).
- сформирован пайплайн для обучения модели. Пайплайн сохранен в pickle-файл, для его нормальной работы требуется предобработка датасета.
- разработан сервис на FastAPI для получения предсказания стоимость авто. Сервис принимает в качестве входных данных либо одиночные JSON-объекты и их коллекции, либо csv-файл.

Что не удалось сделать (к сожалению, главным образом не хватило времени):
- не удалось оптимизировать код (в частности, при разборе данных о крутящего момента и обучении моделей);
- не удалось правильно реализовать модель с L0-регрессией: выполняется простой перебор моделей по критерию Акаике с некоторыми зануленными признаками;
- не удалось провести более детальную работу по улучшению качества моделей: правильно предобработать признаки с "ненормальным" распределением и подобрать оптимальную стратегию удаления выбросов;
- проработать функционал сервиса: асинхронность, многопоточность, обработка ошибок (некоторые ошибки во входных данных не обрабатываются). С другой стороны, конкретных требований к сервису не в задании предъявлено не было.

P.S. Думаю, кот с картинки принадлежит https://t.me/alonagolubovich.

Записи запросов и ответов сервиса (тут гифки, надо пару секунд, чтобы они прогрузились).
1. GET-запрос:
![get](https://github.com/user-attachments/assets/4d3551ec-f9f6-4133-b0d7-e7ea72fa228a)

2. POST-запрос для одиночного объекта (объект не соержит ошибок):
![post-item-true](https://github.com/user-attachments/assets/2a917b12-934b-4133-9053-16ed8df0be70)

3. POST-запрос для одиночного объекта (объект содержит ошибки):
![post-item-false](https://github.com/user-attachments/assets/77926363-b953-48e7-8493-1924ea29f132)

4. POST-запрос для коллекции объектов (коллекция не соержит ошибок):
![post-items-true](https://github.com/user-attachments/assets/9e773ef1-e1c4-4f51-9b49-a105ea5473de)

5. POST-запрос для коллекции объектов (коллекция содержит ошибки):
![post-items-false](https://github.com/user-attachments/assets/6db26adb-e6f2-49e0-aae8-f5a1ae583283)

6. POST-запрос для csv-файла. Здвесь проще приложить скриншоты:
- исходный файл:
![2024-12-03_16-40-50](https://github.com/user-attachments/assets/eac79b23-b0f0-42a9-84ba-4cb272654cbb)

- ответ сервиса:
![2024-12-03_16-41-52](https://github.com/user-attachments/assets/8c785e46-a4f5-4af2-9037-1b432527b323)

- файл с предсказаниями:
![2024-12-03_16-42-11](https://github.com/user-attachments/assets/97342375-6d6f-40f8-b952-023f8bab11ca)
